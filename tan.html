<!DOCTYPE html PUBLIC" -//W3C//DTD XHTML 1.0 Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html ng-app="newsandactions" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=0" />
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-filter/0.5.1/angular-filter.js"></script>
    <script src="app.js"></script>
    <link href="gstyle.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;subset=cyrillic" rel="stylesheet">
</head>

<body>
    <div ng-controller="list" class="controller">
        <div class='preloader'></div>
        <div class="container">
            <div class='actionlist'>
                <div ng-repeat="(type,items) in pdata" class='datatype'>
                    <h1>{{type}}</h1>
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th ng-if="props.in_table" ng-repeat="(field,props) in fields[type]">
                                    {{props.name}}
                                </th>
                                <th>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-if="!taction.deleted" ng-repeat="(ndx,taction) in items" ng-init="!taction.title?taction.title='Транзакция №'+ndx:''"
                                ng-click="opendetails(taction)">
                                <td ng-class="taction.class">{{ndx+1}}</td>
                                <td ng-if="fields[type][field].in_table" ng-repeat="(field,val) in taction" ng-init="
                                val&&fields[type][field].true_class?taction.class=fields[type][field].true_class:'';
                                !val&&fields[type][field].false_class?taction.class=fields[type][field].false_class:'';
                                    val&&fields[type][field].true_val?val=fields[type][field].true_val:''; 
                                    !val&&fields[type][field].false_val?val=fields[type][field].false_val:'';
                                    ">
                                    {{val}}
                                </td>
                                <td ng-click="taction.deleted=true">&times;
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div ng-if="itemdetails&&!this_item.deleted" class='modal'>
            <div class='modal-content'>
                <span ng-click="closemodal()" class="modalclose">&times;</span>
                <p ng-class="fields[this_item.type][field].class" ng-if="fields[this_item.type][field].in_details" ng-repeat="(field,val) in this_item">
                    <strong ng-if="fields[this_item.type][field].showname">{{fields[this_item.type][field].name}}:</strong> {{val}}
                </p>
                <div class='modal-bottom'>
                    <!--   <div ng-if="this_item.type==='news'">
                        <input id='checked' type="checkbox" ng-checked="this_item.checked" ng-model="this_item.checked " />
                        <label for="checked">Я ознакомился</label>
                    </div> -->
                    <div ng-repeat="(name,prop) in props[this_item.type]">
                        <div ng-if="prop.type==='button'" class="prop_section {{name}}">
                            <button ng-click="this_item[name] = prop['value']" class="{{name}}">{{prop['name']}}</button>
                        </div>
                        <div ng-if="prop.type==='checkbox'" class="prop_section {{name}}">
                            <input ng-click="this_item.class!=prop.class?this_item.class=prop.class:this_item.class=''" ng-checked="this_item[name]"
                                ng-model="this_item[name]" type="{{prop.type}}" />
                            <label>{{prop['name']}}</label>
                        </div>
                        <div ng-if="prop.type!='checkbox'&&prop.type!='button'" class="prop_section {{name}}">
                            <input value='{{prop.val}}' ng-model="this_item[name]" type="{{prop.type}}" />
                            <label>{{prop['name']}}</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class='modalback' ng-click="closemodal() "></div>
        </div>
        <div ng-if="openeditaction " id="editaction " class='modal'>
            <span></span>
        </div>
        <div ng-if="openadditem " id="additem " class='modal'>
            <span></span>
        </div>
    </div>
</body>

</html>